<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="./css/mui.min.css" rel="stylesheet" />
		<link href="./css/mui-icon-extra.css" rel="stylesheet" />
		<link href="./css/icon.css" rel="stylesheet" />
		<style>
			.mui-segmented-control.mui-segmented-control-inverted .mui-control-item {
				color: #646464;
			}
			
			.mui-segmented-control.mui-segmented-control-inverted .mui-control-item.mui-active {
				color: #f63;
				border-bottom: 0;
			}
			
			.mui-bar-header-secondary {
				background-color: #fff;
				box-shadow: 0 0 1px rgba(0, 0, 0, .5);
				height: 44px;
				padding: 5px;
			}
			#compose-box{
				position: absolute;
				width:13vw;
				height:13vw;
				bottom: 10vh;
				right:10vw;
				border-radius: 10vw;
				box-shadow: #AAAAAA 3px 3px 3px;
			}
			.mui-icon-extra{
				opacity: 0.7;
			}
			#openPopover{
				margin-left: 0px;
				margin-bottom: 0px;
			}
			.container{
				background: radial-gradient(rgba(0,200,247,255),rgba(3,43,249,255));;
				width: 10vw;
				height:10vw;
				position: absolute;
				top:20vw;
				left:5vw;
				border-radius: 5vw;
			}
		</style>
	</head>
	<body>
		<nav class="mui-bar mui-bar-tab">
			<a data-href="service.html" class="currentWv mui-tab-item mui-active">
				<span class="mui-icon mui-icon-extra mui-icon-extra-home"></span>
				<span class="mui-tab-label">服务</span>
			</a>
			<a  data-href="find.html" class="mui-tab-item">
				<span class="mui-icon mui-icon-extra mui-icon-extra-compass"></span>
				<span class="mui-tab-label">发现</span>
			</a>
			<a  data-href="contacts.html" class="mui-tab-item">
				<span class="mui-icon mui-icon-extra mui-icon-extra-comment"></span>
				<span class="mui-tab-label">消息</span>
			</a>
			<a  data-href="mine.html" class="mui-tab-item" id="mine">
				<span class="mui-icon mui-icon-extra mui-icon-extra-user"></span>
				<span class="mui-tab-label">我的</span>
			</a>
		</nav>
		<div class="mui-content">
			<a href="#popover" id="openPopover" style="position: absolute;bottom:20vw; right:10vw">
				<p class="container">
					<span class="mui-icon mui-icon-extra mui-icon-extra-add1"></span>
				</p>
			</a>
		</div>
		<div id="popover" class="mui-popover">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell"><a href="#">Item1</a></li>
				<li class="mui-table-view-cell"><a href="#">Item2</a></li>
				<li class="mui-table-view-cell"><a href="#">Item3</a></li>
				<li class="mui-table-view-cell"><a href="#">Item4</a></li>
			</ul>
		</div>
	</body>
	<script src="js/mui.min.js"></script>
	<script src="js/weschool.js"></script>
	<script type="text/javascript">
		mui.init({
			preloadPages:[{
				url:"service.html",
				id:"service.html"
			},{
				url:"find.html",
				id:"find.html"
			},{
				url:"contacts.html",
				id:"contacts.html"
			}]
		});
		document.addEventListener('plusready',function(){
			var subpages = ["service.html","find.html","contacts.html"];
			//判断用户是否已登录
			if(WeSchoolApp.Token.GetUserToken()){
				//用户已登录
				var mine = document.getElementById("mine");
				mine.setAttribute('data-href','mine.html');
				subpages.push("mine.html");
			}else{
				//用户未登录
				subpages.push("./login/login.html");
				var mine = document.getElementById("mine");
				mine.setAttribute('data-href','./login/login.html');
			}
			var subpage_style = {
				top:"0px",
				bottom:"51px"
			};
			var self = plus.webview.currentWebview();
			var activeTab = null;
			for(var i = 0;i<4;i++){
				var sub = plus.webview.create(subpages[i],subpages[i],subpage_style);
				if(i>0){
					sub.hide();
				}else{
					activeTab = subpages[i]
				}
				self.append(sub);
			}
			mui(".mui-bar-tab").on("tap","a",function(e){
				var targetTab = this.getAttribute("data-href");
				if(targetTab == activeTab){
					return;
				};
				plus.webview.hide(activeTab);
				plus.webview.show(targetTab);
				//更改当前活跃的选项
				activeTab = targetTab;
			})
		});
	</script>
</html>
